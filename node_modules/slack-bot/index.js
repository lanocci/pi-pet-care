const Botkit = require('botkit');
var exec = require('child_process').exec;
var token = 'your-slack-token'
//var execSync = require('child_process').execSync;

//if (!process.env.token) {
//    console.log('Error: Specify token in the environment');
//    process.exit(1);
//}

const controller = Botkit.slackbot({
    debug: false
});

controller.spawn({
    token
}).startRTM(function(err){
    if(err) {
	throw new Error(err);
    }
});

// respond to request
controller.hears("寒い？", ['direct_message', 'direct_mention', 'mention'], function(bot,message) {
    exec('ruby /home/pi/Projects/pi-pet-care/Controller.rb bot', function(err, stdout, stderr){
	if (err) { console.log(err); }
	var result = stdout.toString();
	bot.reply(message,result);
    }
    //const result = execSync('ruby /home/pi/Projects/pi-pet-care/Controller.rb bot').toString();
	 //bot.reply(message, result)
	)
});
